<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
 
 <mapper namespace="com.sist.mapper.order-mapper">
 	<select id="OrderList" resultType="OrderVO" parameterType="hashmap">
 		SELECT * 
 		FROM order
 		WHERE to_char(odate,'yyyy-mm-dd')=to_char(sysdate,'yyyy-mm-dd')
 		AND id=#{id}
 		ORDER BY odate desc
 	</select>
 	<insert id="insertNewOrder" parameterType="OrderVO">
 		<selectKey resultType="int" keyProperty="order1_orderno_seq" order="BEFORE">
 			SELECT order1_orderno_seq.nextval 
 			FROM dual
 		</selectKey>
 		INSERT INTO order1(oderno2,id,dombookno,forbookno,usedbookno,classno,title,qty,price,poster,recipient,recipienthp,addr1,addr2,deliveryway,
 							memo,payment,cardcompany,ordererhp,dstatus,odate)
 		VALUES (#{order1_orderno_seq},#{id},#{dombookno},#{forbookno},#{usedbookno},#{classno},#{title},#{qty},#{price},#{poster},
 				#{recipient},#{recipienthp},#{addr1},#{addr2},#{deliveryway},#{memo},#{payment},
 				#{cardcompany},#{ordererhp},#{dstatus},#{odate})
 	</insert>
 	
 	<select id="selectOrderno2" resultType="int">
 		SELECT order1_orderno2_seq.nextval from dual
 	</select>
 	
 	<delete id="deleteProductsFromCart" parameterType="hashmap">
	  DELETE FROM cart
	  WHERE dombookno=#{dombookno}
	  OR forbookno#{forbookno}
	  OR usedbookno=#{usedbookno}
	  OR classno=#{classno}
	</delete>
 </mapper>
 
	
	